import{d as z,a as I,x as F,D as R,k as C,f as S,o as h,e,m as T,g as q,i as _,j as B,C as A,y as x,E as G,G as se,v as oe,B as M,_ as H,H as re,p as ie,I as ue,F as X,z as Y,h as Z,J as ee}from"./index-Bjatt9vk.js";import{m as K,a as V}from"./model-DI2kR3Im.js";import{e as ve,l as le}from"./editor.main-L52Bu6xS.js";import{s as ae}from"./function-call-BZo3EOhi.js";const Q={API_LLM:"api_llm",API_EMBEDDING:"api_embedding",SENTENCE_TRANSFORMERS_EMBEDDING:"sentence_transformers_embedding"},te={REMOTE_API:"remote_api",LOCAL:"local"},P={LLM:"llm",EMBEDDING:"embedding",SENTIMENT_CLASSIFICATION:"sentiment_classification",TOKEN_CLASSIFICATION:"token_classification",IMAGE_GENERATION:"image_generation",SPEECH_RECOGNITION:"speech_recognition",TEXT_TO_SPEECH:"text_to_speech"},ce={key:0,class:"g-provider-modal-overlay"},me={class:"m-modal-header"},pe={class:"m-modal-body"},fe={class:"f-form-item"},be=["disabled"],ye={key:0,class:"f-error-text"},ge={class:"f-form-item"},Ce=["disabled"],he={key:0,class:"f-error-text"},Te={class:"f-form-item"},Ne=["disabled"],Ie={key:0,class:"f-error-text"},_e={class:"f-form-item"},we={class:"f-input-wrapper"},Ee=["type","disabled"],Me={key:0,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},$e={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},Se={key:0,class:"f-error-text"},xe={class:"f-form-item"},ke={class:"f-switch-wrapper"},Be=["disabled"],Ae={class:"f-switch-label"},Ue={class:"f-form-item"},Oe=["disabled"],Pe={class:"m-modal-footer"},Le=["disabled"],Ve=z({__name:"ProviderModal",props:{visible:{type:Boolean,default:!1},mode:{default:"create"},providerId:{default:void 0}},emits:["update:visible","success"],setup(c,{emit:U}){const g=c,w=U,t=I({providerName:"",providerType:"openai",apiBaseUrl:"",apiKey:"",isEnabled:!0,description:""}),n=I({}),d=I(!1),b=I(!1),a=F(()=>({create:"新建提供商",edit:"编辑提供商",view:"查看提供商"})[g.mode]),y=()=>{n.value={};let u=!0;return t.value.providerName?.trim()||(n.value.providerName="请输入提供商名称",u=!1),t.value.providerType?.trim()||(n.value.providerType="请输入提供商类型",u=!1),t.value.apiBaseUrl?.trim()?/^https?:\/\/.+/.test(t.value.apiBaseUrl)||(n.value.apiBaseUrl="请输入有效的URL地址",u=!1):(n.value.apiBaseUrl="请输入API基础URL",u=!1),t.value.apiKey?.trim()||(n.value.apiKey="请输入API密钥",u=!1),u},k=async()=>{if(g.providerId)try{d.value=!0;const u=await K.getProviderById(g.providerId);t.value={providerName:u.providerName,providerType:u.providerType,apiBaseUrl:u.apiBaseUrl||"",apiKey:u.apiKey||"",isEnabled:u.isEnabled,description:u.description||""}}catch(u){M("加载提供商详情失败"),console.error("加载提供商详情失败:",u)}finally{d.value=!1}},r=async()=>{if(y())try{d.value=!0,g.mode==="create"?(await K.createProvider({providerName:t.value.providerName,providerType:t.value.providerType,apiBaseUrl:t.value.apiBaseUrl,apiKey:t.value.apiKey,isEnabled:t.value.isEnabled,description:t.value.description}),M("创建成功"),w("success"),N()):g.mode==="edit"&&g.providerId&&(await K.updateProvider(g.providerId,{providerName:t.value.providerName,providerType:t.value.providerType,apiBaseUrl:t.value.apiBaseUrl,apiKey:t.value.apiKey,isEnabled:t.value.isEnabled,description:t.value.description}),M("更新成功"),w("success"),N())}catch(u){M("操作失败"),console.error("提交失败:",u)}finally{d.value=!1}},N=()=>{w("update:visible",!1),setTimeout(()=>{t.value={providerName:"",providerType:"openai",apiBaseUrl:"",apiKey:"",isEnabled:!0,description:""},n.value={},b.value=!1},300)};return R(()=>g.visible,u=>{u&&(g.mode==="edit"||g.mode==="view")&&k()}),(u,s)=>c.visible?(h(),C("div",ce,[e("div",{class:"m-provider-modal",onClick:s[7]||(s[7]=q(()=>{},["stop"]))},[e("div",me,[e("h3",null,T(a.value),1),e("button",{class:"f-close-btn",onClick:N},"×")]),e("div",pe,[e("form",{onSubmit:q(r,["prevent"])},[e("div",fe,[s[8]||(s[8]=e("label",{class:"f-label"},[B(" 提供商名称 "),e("span",{class:"f-required"},"*")],-1)),_(e("input",{"onUpdate:modelValue":s[0]||(s[0]=m=>t.value.providerName=m),type:"text",class:x(["f-input",{"is-error":n.value.providerName}]),placeholder:"请输入提供商名称",disabled:c.mode==="view"},null,10,be),[[A,t.value.providerName]]),n.value.providerName?(h(),C("span",ye,T(n.value.providerName),1)):S("",!0)]),e("div",ge,[s[10]||(s[10]=e("label",{class:"f-label"},[B(" 提供商协议类型 "),e("span",{class:"f-required"},"*")],-1)),_(e("select",{"onUpdate:modelValue":s[1]||(s[1]=m=>t.value.providerType=m),class:x(["f-select",{"is-error":n.value.providerType}]),disabled:c.mode==="view"},[...s[9]||(s[9]=[e("option",{value:"",disabled:""},"请选择协议类型",-1),e("option",{value:"openai"},"OpenAI",-1),e("option",{value:"anthropic"},"Anthropic",-1)])],10,Ce),[[G,t.value.providerType]]),n.value.providerType?(h(),C("span",he,T(n.value.providerType),1)):S("",!0)]),e("div",Te,[s[11]||(s[11]=e("label",{class:"f-label"},[B(" API基础URL "),e("span",{class:"f-required"},"*")],-1)),_(e("input",{"onUpdate:modelValue":s[2]||(s[2]=m=>t.value.apiBaseUrl=m),type:"text",class:x(["f-input",{"is-error":n.value.apiBaseUrl}]),placeholder:"例如: https://api.openai.com/v1",disabled:c.mode==="view"},null,10,Ne),[[A,t.value.apiBaseUrl]]),n.value.apiBaseUrl?(h(),C("span",Ie,T(n.value.apiBaseUrl),1)):S("",!0)]),e("div",_e,[s[14]||(s[14]=e("label",{class:"f-label"},[B(" API密钥 "),e("span",{class:"f-required"},"*")],-1)),e("div",we,[_(e("input",{"onUpdate:modelValue":s[3]||(s[3]=m=>t.value.apiKey=m),type:b.value?"text":"password",class:x(["f-input",{"is-error":n.value.apiKey}]),placeholder:"请输入API密钥",disabled:c.mode==="view"},null,10,Ee),[[se,t.value.apiKey]]),e("button",{type:"button",class:"f-eye-btn",onClick:s[4]||(s[4]=m=>b.value=!b.value)},[b.value?(h(),C("svg",Me,[...s[12]||(s[12]=[e("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"},null,-1),e("circle",{cx:"12",cy:"12",r:"3"},null,-1)])])):(h(),C("svg",$e,[...s[13]||(s[13]=[e("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"},null,-1),e("line",{x1:"1",y1:"1",x2:"23",y2:"23"},null,-1)])]))])]),n.value.apiKey?(h(),C("span",Se,T(n.value.apiKey),1)):S("",!0)]),e("div",xe,[s[15]||(s[15]=e("label",{class:"f-label"},[B(" 是否启用 "),e("span",{class:"f-required"},"*")],-1)),e("div",ke,[_(e("input",{"onUpdate:modelValue":s[5]||(s[5]=m=>t.value.isEnabled=m),type:"checkbox",class:"f-switch",disabled:c.mode==="view"},null,8,Be),[[oe,t.value.isEnabled]]),e("span",Ae,T(t.value.isEnabled?"已启用":"已禁用"),1)])]),e("div",Ue,[s[16]||(s[16]=e("label",{class:"f-label"},"描述信息",-1)),_(e("textarea",{"onUpdate:modelValue":s[6]||(s[6]=m=>t.value.description=m),class:"f-textarea",placeholder:"请输入描述信息(可选)",disabled:c.mode==="view",rows:"3"},null,8,Oe),[[A,t.value.description]])])],32)]),e("div",Pe,[e("button",{class:"f-btn",onClick:N},T(c.mode==="view"?"关闭":"取消"),1),c.mode!=="view"?(h(),C("button",{key:0,class:"f-btn f-btn-primary",disabled:d.value,onClick:r},T(d.value?"提交中...":"确定"),9,Le)):S("",!0)])])])):S("",!0)}}),Ke=H(Ve,[["__scopeId","data-v-01623f66"]]),De=z({__name:"JsonEditor",props:{modelValue:{default:""},placeholder:{default:""},disabled:{type:Boolean,default:!1},height:{default:"200px"},schema:{default:void 0}},emits:["update:modelValue","change","blur"],setup(c,{expose:U,emit:g}){re(r=>({v598be11e:r.height}));const w=c,t=g,n=I();let d=null;ie(()=>{n.value&&(d=ve.create(n.value,{value:w.modelValue||"",language:"json",theme:"vs-dark",automaticLayout:!0,minimap:{enabled:!1},scrollBeyondLastLine:!1,fontSize:14,lineNumbers:"on",readOnly:w.disabled,tabSize:2,insertSpaces:!0,formatOnPaste:!0,formatOnType:!0,autoClosingBrackets:"always",autoClosingQuotes:"always",autoIndent:"full",quickSuggestions:{other:"on",comments:"off",strings:"on"},suggestOnTriggerCharacters:!0,acceptSuggestionOnEnter:"on",wordBasedSuggestions:"off",suggest:{showWords:!1,showSnippets:!1}}),d.onDidChangeModelContent(()=>{const r=d?.getValue()||"";t("update:modelValue",r),t("change",r)}),d.onDidBlurEditorText(()=>{t("blur")}),w.schema&&b(w.schema))});const b=r=>{let N={};if(typeof r=="string")try{N=JSON.parse(r)}catch(s){console.warn("无法解析 schema:",s);return}else N=r;const u=Object.keys(N);le.registerCompletionItemProvider("json",{triggerCharacters:['"'," ",`
`],provideCompletionItems:(s,m)=>{const $=s.getValueInRange({startLineNumber:1,startColumn:1,endLineNumber:m.lineNumber,endColumn:m.column});if(!a($))return{suggestions:[]};const o=(s.getLineContent(m.lineNumber).substring(0,m.column-1).match(/"/g)||[]).length%2===1;return{suggestions:u.map(i=>{const E=N[i],L=typeof E=="string"?`"${E}"`:JSON.stringify(E),W=o?i:`"${i}": ${L}`;return{label:i,kind:le.CompletionItemKind.Property,insertText:W,detail:typeof E=="string"?E:JSON.stringify(E),documentation:`建议值: ${L}`,sortText:`0${i}`,filterText:i,range:{startLineNumber:m.lineNumber,startColumn:m.column,endLineNumber:m.lineNumber,endColumn:m.column}}})}}})},a=r=>{let N=0,u=!1,s=!1;for(let m=0;m<r.length;m++){const $=r[m];if(s){s=!1;continue}if($==="\\"){s=!0;continue}if($==='"'){u=!u;continue}u||($==="{"?N++:$==="}"&&N--)}return N>0};return R(()=>w.modelValue,r=>{d&&d.getValue()!==r&&d.setValue(r||"")}),R(()=>w.disabled,r=>{d&&d.updateOptions({readOnly:r})}),R(()=>w.schema,r=>{r&&b(r)}),ue(()=>{d&&(d.dispose(),d=null)}),U({formatJson:()=>{d&&d.getAction("editor.action.formatDocument")?.run()},validateJson:()=>{const r=d?.getValue()||"";if(!r.trim())return{valid:!0};try{return JSON.parse(r),{valid:!0}}catch(N){return{valid:!1,error:N.message}}}}),(r,N)=>(h(),C("div",{ref_key:"editorContainer",ref:n,class:"json-editor"},null,512))}}),Je=H(De,[["__scopeId","data-v-256f6bce"]]),Re={key:0,class:"f-modal-overlay"},je={class:"f-modal-header"},Ge={class:"f-modal-title"},Fe={class:"f-modal-body"},qe={class:"f-form-item"},ze=["disabled"],He={key:0,class:"f-error-text"},We={class:"f-form-item"},Qe=["disabled"],Xe={class:"f-form-item"},Ye=["disabled"],Ze={class:"f-form-item"},el=["disabled"],ll={key:0,class:"f-error-text"},al={class:"f-form-item"},tl=["disabled"],sl=["value"],ol={class:"f-form-item"},il=["disabled"],nl={class:"f-form-item"},dl={class:"f-input-wrapper"},rl=["type","disabled"],ul={key:0,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},vl={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},cl={class:"f-form-item"},ml=["disabled"],pl={key:0,class:"f-form-item"},fl={key:0,class:"f-error-text"},bl={key:1,class:"f-hint-box"},yl={class:"f-hint-json"},gl={class:"f-form-item"},Cl=["disabled"],hl={class:"f-form-item"},Tl={class:"f-switch-wrapper"},Nl={class:"f-switch"},Il=["disabled"],_l={class:"f-switch-label"},wl={class:"f-modal-footer"},El=["disabled"],Ml=z({__name:"ModelModal",props:{visible:{type:Boolean,default:!1},mode:{default:"create"},modelId:{default:void 0}},emits:["update:visible","success"],setup(c,{emit:U}){const g=c,w=U,t=I(!1),n=I(!1),d=I([]),b=I(""),a=I({modelName:"",modelIdentifier:"",modelDisplayName:"",modelCallingType:"",providerId:"",apiBaseUrl:"",apiKey:"",providerType:"",modelConfig:"",description:"",isEnabled:!0}),y=I({}),k=F(()=>{if(b.value)try{const o=b.value.match(/\{[\s\S]*\}/);if(o){const l=JSON.parse(o[0]),i={};return Object.keys(l).forEach(E=>{E.startsWith("$")||(i[E]=l[E])}),i}}catch(o){console.warn("无法解析配置 schema:",o)}}),r=F(()=>{if(!b.value)return"";try{const o=b.value.match(/\{[\s\S]*\}/);if(o){const l=JSON.parse(o[0]),i={};return Object.keys(l).forEach(E=>{if(E.startsWith("$")){const L=E.substring(1);i[L]=l[E]}}),JSON.stringify(i,null,2)}}catch{return b.value}return b.value}),N=()=>{if(!a.value.modelConfig.trim()){y.value.modelConfig="请输入模型配置";return}try{JSON.parse(a.value.modelConfig),delete y.value.modelConfig}catch(o){y.value.modelConfig=`JSON 格式错误: ${o.message}`}};R(()=>g.visible,o=>{o&&(u(),(g.mode==="edit"||g.mode==="view")&&s())});const u=async()=>{try{const o=await K.listProviders();d.value=o||[]}catch(o){console.error("加载提供商列表失败:",o)}},s=async()=>{if(g.modelId)try{t.value=!0;const o=await V.getModelById(g.modelId);a.value={modelName:o.modelName,modelIdentifier:o.modelIdentifier,modelDisplayName:o.modelDisplayName,modelCallingType:o.modelCallingType,providerId:o.providerId||"",apiBaseUrl:o.apiBaseUrl||"",apiKey:o.apiKey||"",providerType:o.providerType||"",modelConfig:o.modelConfig||"{}",description:o.description||"",isEnabled:o.isEnabled},o.modelCallingType&&await $(o.modelCallingType)}catch(o){M("加载模型详情失败"),console.error("加载模型详情失败:",o)}finally{t.value=!1}},m=async()=>{a.value.modelCallingType?await $(a.value.modelCallingType):b.value=""},$=async o=>{try{const l=await V.getModelConfigFormat(o);b.value=l||"请输入JSON格式的配置"}catch(l){console.error("加载配置格式说明失败:",l);const i={api_llm:`示例配置:
{
  "temperature": 0.7,
  "max_tokens": 2000,
  "top_p": 1.0
}`,api_embedding:`示例配置:
{
  "dimensions": 1536,
  "batch_size": 100
}`,sentence_transformers_embedding:`示例配置:
{
  "model_name": "sentence-transformers/all-MiniLM-L6-v2",
  "device": "cpu"
}`};b.value=i[o]||"请输入JSON格式的配置"}},j=()=>{if(y.value={},a.value.modelName.trim()||(y.value.modelName="请输入模型名称"),a.value.modelCallingType||(y.value.modelCallingType="请选择模型调用方式"),!a.value.modelConfig.trim())y.value.modelConfig="请输入模型配置";else try{JSON.parse(a.value.modelConfig)}catch{y.value.modelConfig="模型配置必须是有效的JSON格式"}return Object.keys(y.value).length===0},D=async()=>{if(j())try{if(t.value=!0,g.mode==="create")await V.createModel({modelName:a.value.modelName,modelIdentifier:a.value.modelIdentifier||void 0,modelCallingType:a.value.modelCallingType,providerId:a.value.providerId||void 0,apiBaseUrl:a.value.apiBaseUrl||void 0,apiKey:a.value.apiKey||void 0,providerType:a.value.providerType||void 0,modelConfig:a.value.modelConfig,description:a.value.description||void 0,isEnabled:a.value.isEnabled}),M("创建成功"),w("success"),O();else if(g.mode==="edit"){if(!g.modelId)return;await V.updateModel(g.modelId,{modelName:a.value.modelName,modelCallingType:a.value.modelCallingType,providerId:a.value.providerId||void 0,apiBaseUrl:a.value.apiBaseUrl||void 0,apiKey:a.value.apiKey||void 0,providerType:a.value.providerType||void 0,modelConfig:a.value.modelConfig,description:a.value.description||void 0,isEnabled:a.value.isEnabled}),M("更新成功"),w("success"),O()}}catch(o){M(g.mode==="create"?"创建失败":"更新失败"),console.error("提交失败:",o)}finally{t.value=!1}},O=()=>{w("update:visible",!1),setTimeout(()=>{a.value={modelName:"",modelIdentifier:"",modelDisplayName:"",modelCallingType:"",providerId:"",apiBaseUrl:"",apiKey:"",providerType:"",modelConfig:"",description:"",isEnabled:!0},y.value={},n.value=!1,b.value=""},300)};return(o,l)=>c.visible?(h(),C("div",Re,[e("div",{class:"f-modal",onClick:l[12]||(l[12]=q(()=>{},["stop"]))},[e("div",je,[e("h3",Ge,T(c.mode==="create"?"新建模型":c.mode==="edit"?"编辑模型":"查看模型"),1),e("button",{class:"f-modal-close",onClick:O},"×")]),e("div",Fe,[e("form",{onSubmit:q(D,["prevent"])},[e("div",qe,[l[13]||(l[13]=e("label",{class:"f-label"},[B(" 模型名（调用时将使用该名字进行调用） "),e("span",{class:"f-required"},"*")],-1)),_(e("input",{"onUpdate:modelValue":l[0]||(l[0]=i=>a.value.modelName=i),type:"text",class:x(["f-input",{"is-error":y.value.modelName}]),placeholder:"请输入模型名称",disabled:c.mode==="view"},null,10,ze),[[A,a.value.modelName]]),y.value.modelName?(h(),C("span",He,T(y.value.modelName),1)):S("",!0)]),e("div",We,[l[14]||(l[14]=e("label",{class:"f-label"},"模型显示名称",-1)),_(e("input",{"onUpdate:modelValue":l[1]||(l[1]=i=>a.value.modelDisplayName=i),type:"text",class:"f-input",placeholder:"模型页面上的显示名称",disabled:c.mode==="view"},null,8,Qe),[[A,a.value.modelDisplayName]])]),e("div",Xe,[l[15]||(l[15]=e("label",{class:"f-label"},"模型标识符",-1)),_(e("input",{"onUpdate:modelValue":l[2]||(l[2]=i=>a.value.modelIdentifier=i),type:"text",class:"f-input",placeholder:"全局唯一，应该与调用时指定的模型名称一致",disabled:c.mode==="view"},null,8,Ye),[[A,a.value.modelIdentifier]]),l[16]||(l[16]=e("span",{class:"f-hint-text"},"留空将使用模型名称做模型标识符",-1))]),e("div",Ze,[l[18]||(l[18]=e("label",{class:"f-label"},[B(" 模型调用方式 "),e("span",{class:"f-required"},"*")],-1)),_(e("select",{"onUpdate:modelValue":l[3]||(l[3]=i=>a.value.modelCallingType=i),class:x(["f-select",{"is-error":y.value.modelCallingType}]),disabled:c.mode==="view",onChange:m},[...l[17]||(l[17]=[e("option",{value:""},"请选择模型调用方式",-1),e("option",{value:"api_llm"},"API调用 - LLM模型",-1),e("option",{value:"api_embedding"},"API调用 - Embedding模型",-1),e("option",{value:"sentence_transformers_embedding"},"Sentence Transformers Embedding",-1)])],42,el),[[G,a.value.modelCallingType]]),y.value.modelCallingType?(h(),C("span",ll,T(y.value.modelCallingType),1)):S("",!0)]),e("div",al,[l[20]||(l[20]=e("label",{class:"f-label"},"模型提供商",-1)),_(e("select",{"onUpdate:modelValue":l[4]||(l[4]=i=>a.value.providerId=i),class:"f-select",disabled:c.mode==="view"},[l[19]||(l[19]=e("option",{value:""},"不选择提供商",-1)),(h(!0),C(X,null,Y(d.value,i=>(h(),C("option",{key:i.id,value:i.id},T(i.providerName),9,sl))),128))],8,tl),[[G,a.value.providerId]])]),e("div",ol,[l[21]||(l[21]=e("label",{class:"f-label"},"API基础URL",-1)),_(e("input",{"onUpdate:modelValue":l[5]||(l[5]=i=>a.value.apiBaseUrl=i),type:"text",class:"f-input",placeholder:"请输入API基础URL",disabled:c.mode==="view"},null,8,il),[[A,a.value.apiBaseUrl]])]),e("div",nl,[l[24]||(l[24]=e("label",{class:"f-label"},"API密钥",-1)),e("div",dl,[_(e("input",{"onUpdate:modelValue":l[6]||(l[6]=i=>a.value.apiKey=i),type:n.value?"text":"password",class:"f-input",placeholder:"请输入API密钥",disabled:c.mode==="view"},null,8,rl),[[se,a.value.apiKey]]),e("button",{type:"button",class:"f-eye-btn",onClick:l[7]||(l[7]=i=>n.value=!n.value)},[n.value?(h(),C("svg",ul,[...l[22]||(l[22]=[e("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"},null,-1),e("circle",{cx:"12",cy:"12",r:"3"},null,-1)])])):(h(),C("svg",vl,[...l[23]||(l[23]=[e("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"},null,-1),e("line",{x1:"1",y1:"1",x2:"23",y2:"23"},null,-1)])]))])])]),e("div",cl,[l[26]||(l[26]=e("label",{class:"f-label"},"提供协议类型",-1)),_(e("select",{"onUpdate:modelValue":l[8]||(l[8]=i=>a.value.providerType=i),class:"f-select",disabled:c.mode==="view"},[...l[25]||(l[25]=[e("option",{value:""},"请选择协议类型",-1),e("option",{value:"openai"},"OpenAI",-1),e("option",{value:"anthropic"},"Anthropic",-1)])],8,ml),[[G,a.value.providerType]])]),a.value.modelCallingType?(h(),C("div",pl,[l[28]||(l[28]=e("label",{class:"f-label"},[B(" 模型配置（JSON格式） "),e("span",{class:"f-required"},"*")],-1)),Z(Je,{modelValue:a.value.modelConfig,"onUpdate:modelValue":l[9]||(l[9]=i=>a.value.modelConfig=i),disabled:c.mode==="view",schema:k.value,height:"200px",onBlur:N},null,8,["modelValue","disabled","schema"]),y.value.modelConfig?(h(),C("span",fl,T(y.value.modelConfig),1)):S("",!0),b.value?(h(),C("div",bl,[l[27]||(l[27]=e("div",{class:"f-hint-title"},"配置格式说明：",-1)),e("pre",yl,T(r.value),1)])):S("",!0)])):S("",!0),e("div",gl,[l[29]||(l[29]=e("label",{class:"f-label"},"描述信息",-1)),_(e("textarea",{"onUpdate:modelValue":l[10]||(l[10]=i=>a.value.description=i),class:"f-textarea",rows:"3",placeholder:"请输入描述信息",disabled:c.mode==="view"},null,8,Cl),[[A,a.value.description]])]),e("div",hl,[l[31]||(l[31]=e("label",{class:"f-label"},[B(" 是否启用 "),e("span",{class:"f-required"},"*")],-1)),e("div",Tl,[e("label",Nl,[_(e("input",{"onUpdate:modelValue":l[11]||(l[11]=i=>a.value.isEnabled=i),type:"checkbox",disabled:c.mode==="view"},null,8,Il),[[oe,a.value.isEnabled]]),l[30]||(l[30]=e("span",{class:"f-switch-slider"},null,-1))]),e("span",_l,T(a.value.isEnabled?"已启用":"已禁用"),1)])])],32)]),e("div",wl,[e("button",{type:"button",class:"f-btn",onClick:O},T(c.mode==="view"?"关闭":"取消"),1),c.mode!=="view"?(h(),C("button",{key:0,type:"button",class:"f-btn f-btn-primary",disabled:t.value,onClick:D},T(t.value?"提交中...":"确定"),9,El)):S("",!0)])])])):S("",!0)}}),$l=H(Ml,[["__scopeId","data-v-f34c4639"]]),Sl={class:"g-model-management-view"},xl={class:"m-content"},kl={class:"m-tabs"},Bl={class:"m-tab-content"},Al={class:"f-providers"},Ul={class:"f-provider-header"},Ol={class:"f-provider-name"},Pl={class:"f-provider-code"},Ll={class:"f-provider-actions"},Vl=["onClick"],Kl=["onClick"],Dl=["onClick"],Jl={class:"m-tab-content"},Rl={class:"m-table-container"},jl={class:"m-table-header"},Gl={class:"f-filters"},Fl={class:"f-table"},ql={class:"f-model-name"},zl={class:"f-actions"},Hl=["onClick"],Wl=["onClick"],Ql=["onClick"],Xl=z({__name:"ModelManagementView",setup(c){const U=v=>({[Q.API_LLM]:"API LLM",[Q.API_EMBEDDING]:"API Embedding",[Q.SENTENCE_TRANSFORMERS_EMBEDDING]:"Sentence Transformers"})[v]||v,g=v=>({[te.REMOTE_API]:"远程API",[te.LOCAL]:"本地部署"})[v]||v,w=v=>({[P.LLM]:"大语言模型",[P.EMBEDDING]:"嵌入模型",[P.SENTIMENT_CLASSIFICATION]:"情感分类",[P.TOKEN_CLASSIFICATION]:"标记分类",[P.IMAGE_GENERATION]:"图像生成",[P.SPEECH_RECOGNITION]:"语音识别",[P.TEXT_TO_SPEECH]:"文本转语音"})[v]||v,t=I("providers"),n=I(""),d=I(!1),b=I(!1),a=I("create"),y=I(),k=I(!1),r=I("create"),N=I(),u=I([]),s=I([]),m=async()=>{try{d.value=!0;const v=await K.listProviders();u.value=v||[]}catch(v){M("加载提供商列表失败"),console.error("加载提供商列表失败:",v)}finally{d.value=!1}},$=async()=>{try{d.value=!0;const v=await V.listModels();s.value=v||[]}catch(v){M("加载模型列表失败"),console.error("加载模型列表失败:",v)}finally{d.value=!1}},j=F(()=>{if(!n.value)return s.value;const v=n.value.toLowerCase();return s.value.filter(p=>p.modelName.toLowerCase().includes(v)||p.modelIdentifier.toLowerCase().includes(v))}),D=()=>{a.value="create",y.value=void 0,b.value=!0},O=v=>{a.value="view",y.value=v,b.value=!0},o=v=>{a.value="edit",y.value=v,b.value=!0},l=async v=>{try{await ae({title:"确认删除",message:"确定要删除该提供商吗？删除后无法恢复。",confirmButtonText:"删除",cancelButtonText:"取消",className:"custom-confirm-dialog"}),d.value=!0,await K.deleteProvider(v),M("删除成功"),m()}catch(p){p!=="cancel"&&(M("删除失败"),console.error("删除提供商失败:",p))}finally{d.value=!1}},i=()=>{m()},E=()=>{r.value="create",N.value=void 0,k.value=!0},L=v=>{r.value="view",N.value=v,k.value=!0},W=v=>{r.value="edit",N.value=v,k.value=!0},ne=async v=>{try{await ae({title:"确认删除",message:"确定要删除该模型吗？删除后无法恢复。",confirmButtonText:"删除",cancelButtonText:"取消",className:"custom-confirm-dialog"}),d.value=!0,await V.deleteModel(v),M("删除成功"),$()}catch(p){p!=="cancel"&&(M("删除失败"),console.error("删除模型失败:",p))}finally{d.value=!1}},de=()=>{$()};return ie(()=>{m(),$()}),(v,p)=>(h(),C("div",Sl,[e("div",{class:"m-header"},[p[5]||(p[5]=e("h1",null,"AI 模型管理",-1)),e("div",{class:"f-header-actions"},[e("button",{class:"f-btn f-btn-primary",onClick:D}," + 新建提供商 "),e("button",{class:"f-btn f-btn-primary",onClick:E}," + 新建模型 ")])]),e("div",xl,[e("div",kl,[e("button",{class:x(["f-tab",{active:t.value==="providers"}]),onClick:p[0]||(p[0]=f=>t.value="providers")}," 模型提供商 ",2),e("button",{class:x(["f-tab",{active:t.value==="models"}]),onClick:p[1]||(p[1]=f=>t.value="models")}," AI 模型列表 ",2)]),_(e("div",Bl,[e("div",Al,[(h(!0),C(X,null,Y(u.value,f=>(h(),C("div",{key:f.id,class:"f-provider-card"},[e("div",Ul,[e("div",null,[e("div",Ol,T(f.providerName),1),e("div",Pl,T(f.providerType),1)])]),e("div",Ll,[e("button",{class:"f-btn",onClick:J=>O(f.id)},"查看",8,Vl),e("button",{class:"f-btn",onClick:J=>o(f.id)},"编辑",8,Kl),e("button",{class:"f-btn f-btn-danger",onClick:J=>l(f.id)},"删除",8,Dl)])]))),128))])],512),[[ee,t.value==="providers"]]),_(e("div",Jl,[e("div",Rl,[e("div",jl,[p[6]||(p[6]=e("span",{class:"f-table-title"},"AI 模型列表",-1)),e("div",Gl,[_(e("input",{"onUpdate:modelValue":p[2]||(p[2]=f=>n.value=f),type:"text",class:"f-search",placeholder:"搜索模型..."},null,512),[[A,n.value]])])]),e("table",Fl,[p[7]||(p[7]=e("thead",null,[e("tr",null,[e("th",null,"模型名称"),e("th",null,"模型标识符"),e("th",null,"调用方式"),e("th",null,"接入方式"),e("th",null,"模型类型"),e("th",null,"操作")])],-1)),e("tbody",null,[(h(!0),C(X,null,Y(j.value,f=>(h(),C("tr",{key:f.id},[e("td",null,[e("span",ql,T(f.modelName),1)]),e("td",null,T(f.modelIdentifier),1),e("td",null,[e("span",{class:x(["f-tag",`calling-${f.modelCallingType}`])},T(U(f.modelCallingType)),3)]),e("td",null,[e("span",{class:x(["f-tag",`access-${f.accessType}`])},T(g(f.accessType)),3)]),e("td",null,[e("span",{class:x(["f-tag",`type-${f.modelType}`])},T(w(f.modelType)),3)]),e("td",null,[e("div",zl,[e("button",{class:"f-btn",onClick:J=>L(f.id)},"查看",8,Hl),e("button",{class:"f-btn",onClick:J=>W(f.id)},"编辑",8,Wl),e("button",{class:"f-btn f-btn-danger",onClick:J=>ne(f.id)},"删除",8,Ql)])])]))),128))])])])],512),[[ee,t.value==="models"]])]),Z(Ke,{visible:b.value,"onUpdate:visible":p[3]||(p[3]=f=>b.value=f),mode:a.value,"provider-id":y.value,onSuccess:i},null,8,["visible","mode","provider-id"]),Z($l,{visible:k.value,"onUpdate:visible":p[4]||(p[4]=f=>k.value=f),mode:r.value,"model-id":N.value,onSuccess:de},null,8,["visible","mode","model-id"])]))}}),aa=H(Xl,[["__scopeId","data-v-1e45110e"]]);export{aa as default};
