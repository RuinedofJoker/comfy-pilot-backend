# 实现计划

## Phase 1: 核心对话功能（最高优先级）

### 数据层
- [ ] AgentConversation 实体类（PO/DTO/Entity）
- [ ] AgentMessage 实体类（PO/DTO/Entity）
- [ ] Mapper 接口和 XML 配置

### 业务层
- [ ] AgentConversationService（创建会话、查询会话）
- [ ] AgentMessageService（保存消息、查询历史）
- [ ] LLM 集成服务（调用 LLM API 生成工作流 JSON）

### 接口层
- [ ] AgentConversationController（对话会话 API）
- [ ] 创建会话接口
- [ ] 发送消息接口
- [ ] 获取对话历史接口

### 数据库
- [ ] 执行数据库建表 SQL

## Phase 2: 工作流管理（高优先级）

### 数据层
- [ ] Workflow 实体类（PO/DTO/Entity）
- [ ] WorkflowMapper 接口

### 业务层
- [ ] WorkflowService（CRUD 操作）
- [ ] 工作流状态管理（DRAFT/ACTIVE）

### 接口层
- [ ] WorkflowController（工作流管理 API）
- [ ] 查询工作流列表
- [ ] 获取工作流详情
- [ ] 激活工作流

## Phase 3: 优化和扩展（中优先级）

- [ ] 对话上下文管理优化
- [ ] 工作流 JSON 验证
- [ ] 错误处理和重试机制
- [ ] LLM 调用超时处理

## 待确认问题

### LLM 集成
- [ ] 使用哪个 LLM API（OpenAI/Claude/本地模型）
- [ ] ComfyUI 工作流 JSON 格式规范
- [ ] Prompt 工程策略

### ComfyUI 集成
- [ ] ComfyUI 服务地址和访问方式
- [ ] 工作流 JSON 验证规则
