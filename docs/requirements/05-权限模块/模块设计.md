# 权限模块 - 模块设计

> 本模块负责角色管理、权限控制、访问校验

## 模块功能

### 核心功能
- 角色管理：角色的CRUD操作
- 权限定义管理：权限的定义和管理
- 角色权限关联：为角色分配权限
- 用户角色分配：为用户分配角色
- 权限校验服务：验证用户是否具有特定权限

### 依赖模块
- 认证模块（获取用户角色）
- 用户模块（用户信息查询）

## 业务逻辑

### 1. 角色管理
- 创建角色：验证角色编码唯一性，创建角色记录
- 查询角色：支持分页查询和条件筛选
- 更新角色：更新角色名称和描述
- 删除角色：逻辑删除，系统内置角色不可删除

### 2. 权限定义管理
- 权限采用资源:操作格式（如 workflow:create）
- 系统启动时自动初始化预定义权限
- 支持动态添加新权限定义

### 3. 角色权限关联
- 为角色批量分配权限
- 支持权限的添加和移除
- 查询角色的所有权限

### 4. 用户角色分配
- 为用户分配一个或多个角色
- 新注册用户默认分配USER角色
- 支持角色的添加和移除

### 5. 权限校验
- 基于注解的权限校验（@PreAuthorize）
- 支持角色校验（hasRole）和权限校验（hasPermission）
- 从JWT Token中获取用户ID，查询用户角色和权限
- 使用Redis缓存用户权限信息，提高性能
