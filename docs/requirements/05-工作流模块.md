# 工作流模块设计

## 模块职责
- 工作流 CRUD 管理
- 工作流版本管理
- 工作流收藏功能

## 核心组件

### Domain 层
- **Workflow**: 工作流实体
- **WorkflowVersion**: 工作流版本实体
- **WorkflowRepository**: 工作流仓储接口

### Infrastructure 层
- **WorkflowRepositoryImpl**: 工作流仓储实现
- **WorkflowMapper**: MyBatis-Plus Mapper
- **WorkflowVersionMapper**: 版本 Mapper

### Application 层
- **WorkflowService**: 工作流服务
  - 工作流 CRUD
  - 收藏管理
  - 列表查询(搜索/筛选/排序)
- **WorkflowVersionService**: 版本服务
  - 创建版本快照
  - 版本历史查询
  - 版本回滚

### Interface 层
- **WorkflowController**: 工作流管理接口

## 核心流程

### 工作流保存流程
1. 验证工作流数据
2. 更新工作流记录
3. 创建版本快照
4. 更新最后使用时间

### 版本回滚流程
1. 查询指定版本数据
2. 恢复工作流数据
3. 创建新版本快照
4. 返回回滚结果

## 业务规则
- 删除工作流时检查关联会话
- 版本号自动递增
- 最后使用时间自动更新
