# 数据模型

## Workflow（工作流）

**职责**: 存储 Agent 创建/编辑的 ComfyUI 工作流

| 字段 | 类型 | 说明 |
|------|------|------|
| id | Long | 主键（雪花算法） |
| name | String | 工作流名称 |
| description | String | 工作流描述 |
| workflowData | JSONB | ComfyUI 工作流 JSON |
| status | String | 状态：DRAFT/ACTIVE |
| createdAt/updatedAt | Timestamp | 时间戳（MyBatis-Plus 自动填充） |
| createdBy/updatedBy | Long | 保留字段（暂为 null） |
| deleted | SmallInt | 逻辑删除标记 |

**状态说明**:
- `DRAFT`: 草稿（Agent 编辑中）
- `ACTIVE`: 已激活（可执行）

## AgentConversation（对话会话）

**职责**: 记录 Agent 与用户的对话上下文

| 字段 | 类型 | 说明 |
|------|------|------|
| id | Long | 主键 |
| workflowId | Long | 关联的工作流 ID |
| conversationData | JSONB | 对话历史 JSON |
| status | String | 会话状态：ACTIVE/COMPLETED |
| createdAt/updatedAt | Timestamp | 时间戳 |

**状态说明**:
- `ACTIVE`: 进行中
- `COMPLETED`: 已完成

## AgentMessage（对话消息）

**职责**: 存储对话中的每条消息

| 字段 | 类型 | 说明 |
|------|------|------|
| id | Long | 主键 |
| conversationId | Long | 关联的会话 ID |
| role | String | 角色：USER/ASSISTANT/SYSTEM |
| content | Text | 消息内容 |
| metadata | JSONB | 元数据（如操作类型） |
| createdAt | Timestamp | 创建时间 |

**角色说明**:
- `USER`: 用户消息
- `ASSISTANT`: Agent 回复
- `SYSTEM`: 系统消息
